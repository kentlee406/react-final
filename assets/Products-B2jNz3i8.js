import{r as t,k as e}from"./vendor-DCgf3J4u.js";import{a as g}from"./vendor-axios-B9ygI19o.js";import"./vendor-bootstrap-DsuGXcVh.js";import{a as k,u as A}from"./index-DxO2U8Gs.js";import{P as E}from"./Pagination-D75gfH_0.js";import{a as L,L as I}from"./vendor-router-BS-I_zzl.js";import"./vendor-redux-B-LDsaQv.js";const f="https://ec-course-api.hexschool.io/v2",j="kentlee406";function Q(){const[n,P]=t.useState([]),[d,c]=t.useState(1),[l,m]=t.useState(""),[r,x]=t.useState("全部"),[y,h]=L(),i=6,{showLoading:N,hideLoading:b}=t.useContext(k),{showNotification:o}=A(),S=async()=>{try{N();const s=await g.get(`${f}/api/${j}/products/all`);P(s.data.products),c(1)}catch{o("取得產品列表失敗，請稍後再試","error",8e3)}finally{b()}},v=async s=>{try{m(s);const $={data:{product_id:s,qty:1}};await g.post(`${f}/api/${j}/cart`,$),o("產品已新增至購物車","success",6e3)}catch{o("新增購物車失敗，請稍後再試","error",8e3)}finally{m("")}},w=["全部",...new Set(n.map(s=>s.category).filter(Boolean))],u=y.get("category")||"全部",a=r==="全部"?n:n.filter(s=>s.category===r),p=(d-1)*i,C=a.slice(p,p+i);return t.useEffect(()=>{S()},[]),t.useEffect(()=>{x(u),c(1)},[u]),e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"產品列表"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mb-4",children:w.map(s=>e.jsx("button",{type:"button",className:`btn ${r===s?"btn-success":"btn-outline-success"}`,"aria-pressed":r===s,onClick:()=>{if(x(s),c(1),s==="全部"){h({});return}h({category:s})},children:s},s))}),e.jsx("div",{className:"cards",children:e.jsx("div",{className:"row g-4",children:a&&a.length>0?C.map(s=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxs("div",{className:"card",children:[e.jsx("img",{src:s.imageUrl,className:"card-img-top",alt:s.title}),e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title",children:[e.jsx(I,{to:`/product/${s.id}`,children:s.title}),e.jsx("span",{className:"badge bg-primary ms-2",children:s.category})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx("p",{className:"card-text text-secondary",children:e.jsx("del",{children:s.origin_price})})," 元 / ",s.price," 元"]}),e.jsx("button",{type:"button",className:"btn btn-primary w-100",disabled:l===s.id,onClick:()=>v(s.id),children:l===s.id?"加入中...":"加入購物車"})]})]})},s.id)):"目前尚無產品資料"})}),a.length>i&&e.jsx(E,{products:a,pageSize:i,currentPage:d,setCurrentPage:c})]})}export{Q as default};
