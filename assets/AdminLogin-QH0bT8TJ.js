import{r as u,u as f,k as s}from"./vendor-DCgf3J4u.js";import{b as g}from"./vendor-router-BS-I_zzl.js";import{a as t}from"./vendor-axios-B9ygI19o.js";import{a as j,u as N}from"./index-DkW-5-gO.js";import{g as b,s as y}from"./authToken-DvrakIaH.js";import"./vendor-redux-B-LDsaQv.js";import"./vendor-bootstrap-DsuGXcVh.js";const d="https://ec-course-api.hexschool.io/v2";function E(){const a=g(),{showLoading:r,hideLoading:n}=u.useContext(j),{showNotification:p}=N(),{register:i,handleSubmit:l,formState:{errors:o}}=f(),h=async e=>{try{r();const c=await t.post(`${d}/admin/signin`,e),{token:m}=c.data;y(m),t.defaults.headers.common.Authorization=`${m}`,a("/admin/product")}catch{p("登入失敗，請檢查帳號密碼","error",8e3),n()}};u.useEffect(()=>{const e=b();e&&x(e)},[]);async function x(e){try{r(),t.defaults.headers.common.Authorization=e,await t.post(`${d}/api/user/check`),a("/admin/product")}catch{console.error("驗證失敗或 Token 已過期，請重新登入"),t.defaults.headers.common.Authorization="",n()}}return s.jsx("div",{className:"container",children:s.jsx("div",{className:"row justify-content-center",children:s.jsxs("div",{className:"col-6",children:[s.jsx("h2",{children:"後台登入"}),s.jsxs("form",{id:"form",className:"form-signin",onSubmit:l(h),children:[s.jsxs("div",{className:"input-group",children:[s.jsx("span",{className:"input-group-text",children:"帳號"}),s.jsx("input",{type:"email",className:"form-control",placeholder:"請輸入帳號",...i("username",{required:"帳號為必填"}),autoComplete:"current-username"}),o.username&&s.jsx("span",{className:"text-danger",children:o.username.message})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("span",{className:"input-group-text",children:"密碼"}),s.jsx("input",{type:"password",className:"form-control",placeholder:"請輸入密碼",...i("password",{required:"密碼為必填"}),autoComplete:"current-password"}),o.password&&s.jsx("span",{className:"text-danger",children:o.password.message})]}),s.jsx("button",{type:"submit",className:"btn btn-primary mb-3",children:"登入"}),s.jsx("button",{type:"button",className:"btn btn-secondary mb-3 ms-2",onClick:()=>a("/"),children:"返回前台首頁"})]})]})})})}export{E as default};
