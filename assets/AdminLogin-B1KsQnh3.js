import{r as i,u as g,k as s}from"./vendor-DCgf3J4u.js";import{b as f}from"./vendor-router-BS-I_zzl.js";import{a as c}from"./vendor-axios-B9ygI19o.js";import{a as j,u as N}from"./index-DZtdyBwW.js";import{g as b,s as y}from"./authToken-DvrakIaH.js";import"./vendor-redux-B-LDsaQv.js";import"./vendor-bootstrap-DsuGXcVh.js";const m="https://ec-course-api.hexschool.io/v2";function E(){const o=f(),{showLoading:a,hideLoading:n}=i.useContext(j),{showNotification:u}=N(),{register:r,handleSubmit:l,formState:{errors:t}}=g(),p=async e=>{try{a();const h=await c.post(`${m}/admin/signin`,e),{token:x}=h.data;y(x),o("/admin/product")}catch{u("登入失敗，請檢查帳號密碼","error",8e3),n()}},d=async e=>{try{a(),await c.post(`${m}/api/user/check`,null,{headers:{Authorization:e}}),o("/admin/product")}catch{console.error("驗證失敗或 Token 已過期，請重新登入"),n()}};return i.useEffect(()=>{const e=b();e&&d(e)},[]),s.jsx("div",{className:"container",children:s.jsx("div",{className:"row justify-content-center",children:s.jsxs("div",{className:"col-12 col-lg-6",children:[s.jsx("h2",{children:"後台登入"}),s.jsxs("form",{id:"form",className:"form-signin",onSubmit:l(p),children:[s.jsxs("div",{className:"input-group",children:[s.jsx("span",{className:"input-group-text",children:"帳號"}),s.jsx("input",{type:"email",className:"form-control",placeholder:"請輸入帳號",...r("username",{required:"帳號為必填"}),autoComplete:"current-username"}),t.username&&s.jsx("span",{className:"text-danger",children:t.username.message})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("span",{className:"input-group-text",children:"密碼"}),s.jsx("input",{type:"password",className:"form-control",placeholder:"請輸入密碼",...r("password",{required:"密碼為必填"}),autoComplete:"current-password"}),t.password&&s.jsx("span",{className:"text-danger",children:t.password.message})]}),s.jsx("button",{type:"submit",className:"btn btn-primary mb-3",children:"登入"}),s.jsx("button",{type:"button",className:"btn btn-secondary mb-3 ms-2",onClick:()=>o("/"),children:"返回前台首頁"})]})]})})})}export{E as default};
